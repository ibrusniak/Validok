# Validok — валидатор данных для 1С

Представляет собой единую функцию **"Валидация(Значение, ШаблонJson)"**.

## Параметры функции

- *ШаблонJson* — Строка в нотации JSON;
- *Значение* — значение поддерживаего валидатором типа, подлежащее валидации.

## Поддерживаемые валидатором типы данных (расширяется)

- Число
- Строка

## Возвращаемое значение

Тип — Структура, содержит два ключа.

- *Результат* — Булево, признак успешности валидации данных;
- *Ошибки* — Массив строк, содержащих описание ошибок валидации.

## Файлы

- **Validok.bsl** — модуль на встроенном языке 1С, реализующий функцию **"Валидация(Шаблон, Данные)"**;
- **Validok.epf** — внешняя обработка 1С, предназначенная для интерактивного тестирования валидатора.

---

## Принципы описания шаблонов

### Общие принципы

Шаблон валидации представляет собой строку в нотации JSON. Это объект, у которого должны присутствовать следующие поля:

- **Тип** - Строка - обязательно. Описывает тип значения, которое будет проходить валидацию по данному шаблону;
- **Обязательно** - Булево - обязательно. Определяет, обязательно ли присутствие значения. Для примитивного типа - проверяет не является ли значение пустым значением для типа. Для составного объекта определяет еще и наличие такого поля в объекте;
- **Мин** - Число - опционально. Для типа Число - минимальное значение, для типа Строка - минимальное число симовлов, для типа Массив - минимальное число элементов. Может отсутствовать в шаблоне, тогда соответствующая проверка не проводится;
- **Макс** - Число - опционально. Для типа Число - максимальное значение, для типа Строка - максимальное число симовлов, для типа Массив - максимальное число элементов. Может отсутствовать в шаблоне, тогда соответствующая проверка не проводится;

Если заданы **Мин** или **Макс** и значением меньше или равно 0 тогда даже при установленном флаге **Обязательно** Число 0, пустая строка или пустой массив будут проходить валидацию, так как их размер входит в диапазон. Оба работают по принципу "включительно".

### Валидация данных типа Число

```json
{
    "Тип": "Число",
    "Обязательно": false
}
```

Означает: значение должно быть типа Число, может быть пустым (0)

```json
{
    "Тип": "Число",
    "Обязательно": true,
    "Мин": -7
}
```

Означает: значение должно быть типа Число, может быть пустым (**Мин** разрешает нулевое значение)

```json
{
    "Тип": "Число",
    "Обязательно": true,
    "Мин": -7,
    "Макс": -3
}
```

Означает: значение должно быть типа Число, должно быть между -3 и -7 включительно.

### Валидация данных типа Строка

Кроме перечисленных в описании для типа Число, есть новое правило: **РегулярноеВыражение**. Как можно догадаться, валидация будет пройдена, если значение соответствует регулярному выражению. В регулярном выражении не следует использовать начало строки и конец строки ('^' и '$'). **РегулярноеВыражение** должно быть не пустой строкой. Кроме того, **Мин** не может быть меньше 0 а **Макс** не может быть меньше 1.

```json
{
    "Тип": "Строка",
    "Обязательно": true,
    "Мин": 5,
    "Макс": 50,
    "РегулярноеВыражение": ".*@.*"
}
```
