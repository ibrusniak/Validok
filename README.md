# Validok — валидатор данных для 1С

Представляет собой единую функцию **"Валидация(Шаблон, Данные)"**.

## Параметры функции

- *Шаблон* — Массив, содержащий набор, состоящий из 0+ элементов. Элементы массива — типа Соответствие, представляющие собой **правила** валидации отдельных свойств в **данных**. Если массив пуст, валидация считается пройденной в любом случае;
- *Данные* — Соответствие, содержащий произвольные данные, подлежащие валидации.

## Возвращаемое значение

Тип — Структура, содержит два ключа.

- *ВалидацияПройдена* — Булево, признак успешности валидации данных;
- *ОшибкиВалидации* — Массив элементов типа Соответствие. Элементы состоят из ключа, **соответствующего** имени поля данных, и значения типа Строка, описывающего ошибку, относящуюся к данному полю.

## Файлы

- **Validok.bsl** — модуль на встроенном языке 1С, реализующий функцию **"Валидация(Шаблон, Данные)"**;
- **Validok.epf** — внешняя обработка 1С, предназначенная для интерактивного тестирования валидатора.

---

## Правила валидации

Далее для описания правил валидации будем использовать нотацию JSON, имея в виду, что для использования в функции валидации JSON должен быть предварительно десериализован в объект типа Соответствие.

### Общие принципы

Минимальный шаблон:

```json
[]
```

При таком шаблоне - валидация будет считаться пройденой всегда.

Шаблон с одним правилом валидации поля данных "ИмяПоляВДанных":

```json
[
    {
        "Имя": "ИмяПоляВДанных",
        "Обязательность": true,
        "Тип": "Строка"
    }
]
```

Любое правило должно обязательно содержать ключи:

- *Имя* — Строка — имя ключа в данных, значение которого проверяется этим правилом;
- *Обязательность* — Булево — определяет, обязательно ли в данных должент быть такой ключ;
- *Тип* — строчное представление простого типа данных 1С (Строка, Число, Булево, Соответствие, Массив) — определяет, какой тип должен быть у данных поля объекта данных.

### Проверка поля типа Число

```json
{
    "Имя": "id",
    "Обязательность": true,
    "Тип": "Число",
    "МинимальноеЗначение": 1,
    "МасимальноеЗначение": 20
}
```

- *МинимальноеЗначение* — Число — не обязателен, определяет минимальное значение;
- *МасимальноеЗначение* — Число — не обязателен, определяет максимальное значение значение.

### Проверка поля типа Строка

```json
{
    "Имя": "first_name",
    "Обязательность": true,
    "Тип": "Строка",
    "МинимальнаяДлина": 3,
    "МаксимальнаяДлина": 50
}
```

- *МинимальнаяДлина* — Число — не обязателен, определяет минимальную длину строки;
- *МаксимальнаяДлина* — Число — не обязателен, определяет максимальную длину строки.

### Проверка поля типа Перечисление (составного объекта)

```json
{
    "Имя": "СоставнойОбъект1",
    "Обязательность": true,
    "Тип": "Соответствие",
    "Шаблон": [
        {
            "Имя": "Поле1",
            "Обязательность": true,
            "Тип": "Строка",
            "МинимальнаяДлина": 10,
            "МаксимальнаяДлина": 200
        },
        {
            "Имя": "Поле2",
            "Обязательность": true,
            "Тип": "Число",
            "МинимальноеЗначение": 20,
            "МаксимальноеЗначение": 50
        }
    ]
}
```

- *Шаблон* — Перечисление — не обязателен, содежит шаблон валидации значения составного объекта. Правила составления этого шаблона такие же как и к шаблону верхнего уровня;
